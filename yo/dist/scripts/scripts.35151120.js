"use strict";function searchFormToQueryParams(a,b){var c={};return"undefined"!=typeof b?("query"in b&&(c.query=b.query),"type"in b&&(c.type=b.type),"facility"in b&&(c.facility=b.facility),"startDate"in b&&(c.startDate=a("date")(b.startDate,"yyyy-MM-dd")),"endDate"in b&&(c.endDate=a("date")(b.endDate,"yyyy-MM-dd")),c):b}window.deferredBootstrapper.bootstrap({element:document.body,module:"angularApp",resolve:{APP_CONFIG:["$http",function(a){return a.get("/data/config.json")}]}}),angular.module("angularApp",["ui.router","ui.router.tabs","ui.bootstrap","datatables","datatables.scroller"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/browse"),a.state("home",{controller:"HomeController",templateUrl:"views/home.html"}).state("home.browse",{url:"/browse",views:{"":{controller:"BrowseController",templateUrl:"views/browse.html"},"searchForm@home.browse":{controller:"SearchFormController",templateUrl:"views/search-form.html"},"browse@home.browse":{controller:"BrowseDataController",templateUrl:"views/browse-content.html"}}}).state("home.cart",{url:"/cart",templateUrl:"views/cart.html"}).state("home.browse.meta-1",{url:"/meta-1?query&type&facility&startDate&endDate",templateUrl:"views/meta/1.html"}).state("home.browse.meta-2",{url:"/meta-2?query&type&facility&startDate&endDate",templateUrl:"views/meta/2.html"}).state("home.browse.meta-3",{url:"/meta-3?query&type&facility&startDate&endDate",templateUrl:"views/meta/3.html"})}]);var HomeController=["$rootScope","$state","$scope",function(a,b,c){c.initialise=function(){c.go=function(a){b.go(a)},c.tabData=[{heading:"Search",route:"home.browse"},{heading:"Cart",route:"home.cart"}]},c.initialise()}];angular.module("angularApp").controller("HomeController",HomeController);var BrowseController=["$rootScope","$state","$scope",function(a,b,c){c.initialise=function(){c.go=function(){},c.tabData=[{heading:"Meta Info 1",route:"home.browse.meta-1"},{heading:"Meta Info 2",route:"home.browse.meta-2"},{heading:"Meta Info 3",route:"home.browse.meta-3"}]},c.initialise()}];angular.module("angularApp").controller("BrowseController",BrowseController);var SearchFormController=["$rootScope","$scope","$state","$stateParams","$log","$filter",function(a,b,c,d,e,f){e.warn(c),"undefined"!=typeof c.params&&(b.searchForm=c.params),b.facilityItems=[{name:"facility 1",id:"facility one"},{name:"facility 2",id:"facility two"},{name:"facility 3",id:"facility three"}],b.searchTypeItems=[{name:"Investigation",id:"investigation"},{name:"Dataset",id:"dataset"},{name:"Datafile",id:"datafile"}],b.formData=[],b.format="yyyy-MM-dd",b.datepickers={startDate:!1,endDate:!1},b.open=function(a,c){a.preventDefault(),a.stopPropagation(),b.closeAll(),b.datepickers[c]=!0},b.closeAll=function(){b.datepickers.startDate=!1,b.datepickers.endDate=!1},b.search=function(){var a=searchFormToQueryParams(f,b.searchForm);c.go("home.browse.meta-1",a)},b.initialise()}];angular.module("angularApp").controller("SearchFormController",SearchFormController);var AddParameterModalController=["$scope","$modal","$log",function(a,b,c){a.open=function(d,e){var f=b.open({templateUrl:"views/search/modal/add-parameter-modal.html",controller:"ModalInstanceCtrl",size:e,resolve:{formData:function(){var b=a.parameters;return a.parameters={},b}}});f.result.then(function(b){c.info(b),a.formData.push(b)},function(){c.info("Modal dismissed at: "+new Date)})}}];angular.module("angularApp").controller("AddParameterModalController",AddParameterModalController),angular.module("angularApp").controller("ModalInstanceCtrl",["$scope","$modalInstance","$log","formData",function(a,b){a.parameterTypes=[{name:"Text",id:"text"},{name:"Number",id:"number"},{name:"Date",id:"date"}],a.ok=function(){b.close(a.formParam)},a.cancel=function(){b.dismiss("cancel")}}]);var BrowseDataController=["$rootScope","$state","$scope","$log","DTOptionsBuilder","DTColumnBuilder","APP_CONFIG",function(a,b,c,d,e,f,g){c.initialise=function(){},d.info(g),c.browseData={};var h=g.site.pagingType;switch(h){case"page":c.browseData.dtOptions=e.fromSource("/data/browse-data.json").withPaginationType("full_numbers").withDOM("frtip").withDisplayLength(5);break;case"scroll":default:c.browseData.dtOptions=e.fromSource("/data/browse-data.json").withDOM("frti").withScroller().withOption("deferRender",!0).withOption("scrollY",180)}var i=[],j="instrument",k=g.servers[0].facility[0].browseColumns[j];for(var l in k)i.push(f.newColumn(k[l].name).withTitle(k[l].title));c.browseData.dtColumns=i,a.$on("$stateChangeStart",function(a,b,d){c.data=d}),c.initialise()}];angular.module("angularApp").controller("BrowseDataController",BrowseDataController);